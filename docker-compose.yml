#This compose file adds draw.io to your stack
version: '3.5'
services:
  drawio:
    image: mondrian/diagrams
    build: ./main
    container_name: mondrian-diagrams
    restart: unless-stopped
    ports:
      - 80:8080
      - 443:8443
    environment:
      PUBLIC_DNS: dev.mondrian-it.io
      DRAWIO_SERVER_URL: https://dev.mondrian-it.io/
      DRAWIO_VIEWER_URL: https://dev.mondrian-it.io/js/viewer.min.js
      DRAWIO_LIGHTBOX_URL: https://dev.mondrian-it.io/
    healthcheck:
      test: ["CMD-SHELL", "curl -f http://domain:8080 || exit 1"]
      interval: 1m30s
      timeout: 10s
      retries: 5
      start_period: 10s
    volumes:
      - ./.keystore:/usr/local/tomcat/.keystore